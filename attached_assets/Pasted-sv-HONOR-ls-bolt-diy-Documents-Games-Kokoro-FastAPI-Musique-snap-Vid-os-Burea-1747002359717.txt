sv@HONOR:~$ ls
bolt.diy  Documents    Games   Kokoro-FastAPI  Musique  snap             Vid√©os
Bureau    FiraxisLive  Images  Mod√®les         Public   T√©l√©chargements
sv@HONOR:~$ git clone https://github.com/svoer/FhirConverter.git
Clonage dans 'FhirConverter'...
remote: Enumerating objects: 7525, done.
remote: Counting objects: 100% (943/943), done.
remote: Compressing objects: 100% (328/328), done.
remote: Total 7525 (delta 694), reused 844 (delta 614), pack-reused 6582 (from 2)
R√©ception d'objets: 100% (7525/7525), 21.17 Mio | 779.00 Kio/s, fait.
R√©solution des deltas: 100% (5745/5745), fait.
sv@HONOR:~$ ls
bolt.diy   FhirConverter  Images          Musique  T√©l√©chargements
Bureau     FiraxisLive    Kokoro-FastAPI  Public   Vid√©os
Documents  Games          Mod√®les         snap
sv@HONOR:~$ rm -rf FhirConverter/
sv@HONOR:~$ docker ps
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
sv@HONOR:~$ git clone https://github.com/svoer/FHIRhub.git
cd FHIRhub
./install.sh
./start.sh
Clonage dans 'FHIRhub'...
Username for 'https://github.com': svoer
Password for 'https://svoer@github.com': 
remote: Support for password authentication was removed on August 13, 2021.
remote: Please see https://docs.github.com/get-started/getting-started-with-git/about-remote-repositories#cloning-with-https-urls for information on currently recommended modes of authentication.
fatal: √âchec d'authentification pour 'https://github.com/svoer/FHIRhub.git/'
bash: cd: FHIRhub: Aucun fichier ou dossier de ce nom
bash: ./install.sh: Aucun fichier ou dossier de ce nom
bash: ./start.sh: Aucun fichier ou dossier de ce nom
sv@HONOR:~$ git clone https://github.com/svoer/FHIRhub.git
cd FHIRhub
./install.sh
./start.sh
Clonage dans 'FHIRhub'...
remote: Enumerating objects: 411, done.
remote: Counting objects: 100% (411/411), done.
remote: Compressing objects: 100% (380/380), done.
remote: Total 411 (delta 14), reused 411 (delta 14), pack-reused 0 (from 0)
R√©ception d'objets: 100% (411/411), 4.87 Mio | 491.00 Kio/s, fait.
R√©solution des deltas: 100% (14/14), fait.
bash: ./install.sh: Permission non accord√©e
bash: ./start.sh: Permission non accord√©e
sv@HONOR:~/FHIRhub$ sudo bash install.sh
[sudo] Mot de passe de sv¬†: 
==========================================================
     Installation de FHIRHub - Convertisseur HL7 vers FHIR
     Version 1.2.0 - ANS Compatible
==========================================================
[1/7] V√©rification de l'environnement...
üßπ D√©sinstallation automatique des versions existantes de Node.js...
üßπ D√©sinstallation des versions existantes de Node.js...
   Utilisation d'apt-get pour d√©sinstaller Node.js...
Lecture des listes de paquets... Fait
Construction de l'arbre des d√©pendances... Fait
Lecture des informations d'√©tat... Fait      
Le paquet ¬´¬†nodejs¬†¬ª n'est pas install√©, et ne peut donc √™tre supprim√©
Le paquet ¬´¬†npm¬†¬ª n'est pas install√©, et ne peut donc √™tre supprim√©
0 mis √† jour, 0 nouvellement install√©s, 0 √† enlever et 24 non mis √† jour.
Lecture des listes de paquets... Fait
Construction de l'arbre des d√©pendances... Fait
Lecture des informations d'√©tat... Fait      
Le paquet ¬´¬†nodejs¬†¬ª n'est pas install√©, et ne peut donc √™tre supprim√©
Le paquet ¬´¬†npm¬†¬ª n'est pas install√©, et ne peut donc √™tre supprim√©
0 mis √† jour, 0 nouvellement install√©s, 0 √† enlever et 24 non mis √† jour.
Lecture des listes de paquets... Fait
Construction de l'arbre des d√©pendances... Fait
Lecture des informations d'√©tat... Fait      
0 mis √† jour, 0 nouvellement install√©s, 0 √† enlever et 24 non mis √† jour.
   Suppression des r√©pertoires Node.js locaux...
‚ö†Ô∏è Impossible de d√©sinstaller Node.js compl√®tement du syst√®me.
   Certains chemins de Node.js restent accessibles : /usr/local/bin/node
   L'installation locale sera quand m√™me utilis√©e.
üì¶ Installation automatique de Node.js v20.15.1 localement...
üì¶ Installation locale de Node.js v20.15.1...
   Nettoyage des installations pr√©c√©dentes...
   T√©l√©chargement de Node.js v20.15.1...
######################################################################### 100.0%
   Extraction de Node.js...
   D√©placement des fichiers Node.js...
   Configuration des permissions des binaires...
‚úÖ Node.js v20.15.1 install√© localement avec succ√®s.
   Version locale de Node.js utilis√©e: v20.15.1
   ‚úì Script de d√©marrage modifi√© pour utiliser Node.js local.
‚úÖ Environnement compatible (Node.js v20.15.1)
[2/7] Cr√©ation des r√©pertoires...
‚úÖ Structure des dossiers de donn√©es cr√©√©e
[2.1/7] V√©rification des d√©pendances volumineuses...
   Ex√©cution du script de t√©l√©chargement des d√©pendances...
==========================================================
   FHIRHub - T√©l√©chargement des d√©pendances volumineuses
   2025-05-12 00:20:02
==========================================================
Le serveur HAPI FHIR n'est pas install√©.
T√©l√©chargement de HAPI FHIR Server v5.4.0...
######################################################################### 100.0%
Le fichier t√©l√©charg√© est trop petit pour √™tre valide (0 Mo).
Tentative avec une URL alternative...
T√©l√©chargement de HAPI FHIR Server v5.4.0 (alt)...
######################################################################### 100.0%
‚úì T√©l√©chargement termin√©: ./hapi-fhir/hapi-fhir-server-starter-5.4.0.jar (213 Mo)
Terminologies fran√ßaises manquantes.
Ex√©cution du script de t√©l√©chargement des terminologies fran√ßaises...
R√©cup√©ration des informations sur les terminologies fran√ßaises...
Erreur d'authentification: 401 {"error":"unauthorized_client","error_description":"Public client not allowed to retrieve service account"}
Erreur lors de la r√©cup√©ration des terminologies: list indices must be integers or slices, not str
Liste de CodeSystems FHIR r√©cup√©r√©e.
Liste de ValueSets FHIR r√©cup√©r√©e.
266 URLs de syst√®mes extraites.
Donn√©es sauvegard√©es dans le r√©pertoire 'french_terminology'
‚úì Terminologies fran√ßaises t√©l√©charg√©es avec succ√®s
==========================================================
   R√©sum√© des d√©pendances
==========================================================
HAPI FHIR: Install√©‚úì
Terminologies fran√ßaises: Non install√©es‚úó
==========================================================
T√©l√©chargement des d√©pendances termin√©.
[3/7] Installation des d√©pendances...
   V√©rification de Python...
   ‚úÖ Python 3 trouv√©: Python 3.12.3
   Installation des modules Python requis...
   ‚úÖ pip3 trouv√©
   Installation des modules hl7 et requests...
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv
   ‚úÖ Modules Python install√©s avec succ√®s
   Installation des modules Node.js...
npm warn deprecated rimraf@3.0.2: Rimraf versions prior to v4 are no longer supported
npm warn deprecated request@2.88.2: request has been deprecated, see https://github.com/request/request/issues/3142
npm warn deprecated q@1.5.1: You or someone you depend on is using Q, the JavaScript Promise library that gave JavaScript developers strong feelings about promises. They can almost certainly migrate to the native JavaScript promise now. Thank you literally everyone for joining me in this bet against the odds. Be excellent to each other.
npm warn deprecated
npm warn deprecated (For a CapTP with native promises, see @endo/eventual-send and @endo/captp)
npm warn deprecated npmlog@5.0.1: This package is no longer supported.
npm warn deprecated node-domexception@1.0.0: Use your platform's native DOMException instead
npm warn deprecated lodash.isequal@4.5.0: This package is deprecated. Use require('node:util').isDeepStrictEqual instead.
npm warn deprecated lodash.get@4.4.2: This package is deprecated. Use the optional chaining (?.) operator instead.
npm warn deprecated inflight@1.0.6: This module is not supported, and leaks memory. Do not use it. Check out lru-cache if you want a good and tested way to coalesce async requests by a key value, which is much more comprehensive and powerful.
npm warn deprecated har-validator@5.1.5: this library is no longer supported
npm warn deprecated gauge@3.0.2: This package is no longer supported.
npm warn deprecated are-we-there-yet@2.0.0: This package is no longer supported.
npm warn deprecated @npmcli/move-file@1.1.2: This functionality has been moved to @npmcli/fs
npm warn deprecated glob@7.2.3: Glob versions prior to v9 are no longer supported
npm warn deprecated uuid@3.4.0: Please upgrade  to version 7 or higher.  Older versions may use Math.random() in certain circumstances, which is known to be problematic.  See https://v8.dev/blog/math-random for details.
npm warn deprecated glob@7.1.6: Glob versions prior to v9 are no longer supported
npm warn deprecated npmlog@6.0.2: This package is no longer supported.
npm warn deprecated glob@7.2.3: Glob versions prior to v9 are no longer supported
npm warn deprecated gauge@4.0.4: This package is no longer supported.
npm warn deprecated are-we-there-yet@3.0.1: This package is no longer supported.
npm warn deprecated glob@7.2.3: Glob versions prior to v9 are no longer supported

added 564 packages, and audited 573 packages in 59s

51 packages are looking for funding
  run `npm fund` for details

4 vulnerabilities (2 moderate, 2 high)

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
npm notice
npm notice New major version of npm available! 10.7.0 -> 11.3.0
npm notice Changelog: https://github.com/npm/cli/releases/tag/v11.3.0
npm notice To update run: npm install -g npm@11.3.0
npm notice
[4/7] Configuration de l'environnement...
   Cr√©ation des r√©pertoires de stockage pour la structure optimis√©e...
   ‚úÖ Structure de r√©pertoires optimis√©e cr√©√©e
‚úÖ Fichier .env cr√©√© avec succ√®s
[5/7] Initialisation de la base de donn√©es...
[DB] Cr√©ation des tables dans la base de donn√©es SQLite...
   Utilisation du chemin de base de donn√©es: ./storage/db/fhirhub.db
   Cr√©ation d'une nouvelle base de donn√©es: ./storage/db/fhirhub.db
   Initialisation des sch√©mas de tables...
   Initialisation de la base de donn√©es avec Node.js...
[DB] D√©marrage de l'initialisation de la base de donn√©es...
[DB] Initialisation de la base de donn√©es...
[DB] Chemin de la base de donn√©es: /home/sv/FHIRhub/storage/db/fhirhub.db
[DB] Connexion √† la base de donn√©es √©tablie
PRAGMA foreign_keys = ON
[DB] Cr√©ation de table: CREATE TABLE IF NOT EXISTS users (
CREATE TABLE IF NOT EXISTS users (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    username TEXT NOT NULL UNIQUE,
    password TEXT NOT NULL,
    email TEXT UNIQUE,
    role TEXT NOT NULL DEFAULT 'user',
    first_name TEXT,
    last_name TEXT,
    last_login TEXT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
  )
[DB] Cr√©ation de table: CREATE TABLE IF NOT EXISTS applications (
CREATE TABLE IF NOT EXISTS applications (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    description TEXT,
    cors_origins TEXT,
    settings TEXT,
    created_at TEXT NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TEXT NOT NULL DEFAULT CURRENT_TIMESTAMP,
    created_by INTEGER,
    FOREIGN KEY (created_by) REFERENCES users(id)
  )
[DB] Cr√©ation de table: CREATE TABLE IF NOT EXISTS api_keys (
CREATE TABLE IF NOT EXISTS api_keys (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    application_id INTEGER NOT NULL,
    key TEXT NOT NULL UNIQUE,
    hashed_key TEXT NOT NULL,
    description TEXT,
    is_active INTEGER DEFAULT 1,
    expires_at DATETIME,
    rate_limit INTEGER DEFAULT 100,
    usage_count INTEGER DEFAULT 0,
    last_used_at DATETIME,
    ip_restrictions TEXT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (application_id) REFERENCES applications(id) ON DELETE CASCADE
  )
[DB] Cr√©ation de table: CREATE TABLE IF NOT EXISTS conversion_logs (
CREATE TABLE IF NOT EXISTS conversion_logs (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    api_key_id INTEGER,
    application_id INTEGER NOT NULL,
    source_type TEXT NOT NULL,
    hl7_content TEXT NOT NULL,
    fhir_content TEXT,
    status TEXT NOT NULL,
    processing_time INTEGER,
    error_message TEXT,
    ip_address TEXT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (api_key_id) REFERENCES api_keys(id) ON DELETE SET NULL,
    FOREIGN KEY (application_id) REFERENCES applications(id) ON DELETE CASCADE
  )
[DB] Cr√©ation de table: CREATE TABLE IF NOT EXISTS system_metrics (
CREATE TABLE IF NOT EXISTS system_metrics (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    cpu_usage REAL,
    memory_usage REAL,
    disk_usage REAL,
    active_connections INTEGER,
    timestamp DATETIME DEFAULT CURRENT_TIMESTAMP
  )
[DB] Cr√©ation de table: CREATE TABLE IF NOT EXISTS notifications (
CREATE TABLE IF NOT EXISTS notifications (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,
    title TEXT NOT NULL,
    message TEXT NOT NULL,
    type TEXT NOT NULL DEFAULT 'info',
    read BOOLEAN NOT NULL DEFAULT 0,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
  )
[DB] Cr√©ation de table: CREATE TABLE IF NOT EXISTS api_activity_logs (
CREATE TABLE IF NOT EXISTS api_activity_logs (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    api_key_id INTEGER,
    application_id INTEGER NOT NULL,
    endpoint TEXT NOT NULL,
    method TEXT NOT NULL,
    status_code INTEGER NOT NULL,
    response_time INTEGER,
    ip_address TEXT,
    user_agent TEXT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (api_key_id) REFERENCES api_keys(id) ON DELETE SET NULL,
    FOREIGN KEY (application_id) REFERENCES applications(id) ON DELETE CASCADE
  )
[DB] Cr√©ation de table: CREATE TABLE IF NOT EXISTS api_usage_limits (
CREATE TABLE IF NOT EXISTS api_usage_limits (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    application_id INTEGER NOT NULL,
    api_key_id INTEGER,
    daily_limit INTEGER DEFAULT 1000,
    monthly_limit INTEGER DEFAULT 10000,
    current_daily_usage INTEGER DEFAULT 0,
    current_monthly_usage INTEGER DEFAULT 0,
    last_reset_daily DATETIME DEFAULT CURRENT_TIMESTAMP,
    last_reset_monthly DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (application_id) REFERENCES applications(id) ON DELETE CASCADE,
    FOREIGN KEY (api_key_id) REFERENCES api_keys(id) ON DELETE CASCADE
  )
[DB] Cr√©ation de table: CREATE TABLE IF NOT EXISTS system_logs (
CREATE TABLE IF NOT EXISTS system_logs (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    event_type TEXT NOT NULL,
    message TEXT NOT NULL,
    details TEXT,
    severity TEXT NOT NULL DEFAULT 'INFO',
    user_id INTEGER,
    ip_address TEXT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE SET NULL
  )
SELECT name FROM sqlite_master WHERE type='table' AND name='users'
[DB] V√©rification des tables cr√©√©es: { lastID: 0, changes: 0 }
SELECT id FROM users WHERE username = 'admin'
[DB] Cr√©ation de l'utilisateur administrateur par d√©faut
INSERT INTO users (username, password, email, role) VALUES ('admin', '6ffe9e0b86bf3688c2339cdcaf4244e1'/*+129 bytes*/, 'admin@fhirhub.local', 'admin')
[DB] V√©rification de l'application par d√©faut et de la cl√© API de d√©veloppement
SELECT id FROM applications WHERE name IN ('Application par d√©faut', 'Default', 'Application par d√©faut pour le '/*+14 bytes*/) LIMIT 1
[DB] Aucune application par d√©faut trouv√©e, cr√©ation...
INSERT INTO applications (name, description, created_by) SELECT 'Application par d√©faut', 'Application g√©n√©r√©e automatiq'/*+29 bytes*/, (SELECT id FROM users WHERE username = 'admin')
SELECT id FROM api_keys WHERE key = 'dev-key' LIMIT 1
[DB] Cl√© API de d√©veloppement non trouv√©e, cr√©ation...
SELECT id FROM applications WHERE name IN ('Application par d√©faut', 'Default', 'Application par d√©faut pour le '/*+14 bytes*/) LIMIT 1
INSERT INTO api_keys (application_id, key, hashed_key, description, is_active, created_at) VALUES (1.0, 'dev-key', '7e9f8fd111802be56c379d597842e29b'/*+32 bytes*/, 'Cl√© de d√©veloppement pour test'/*+1 bytes*/, 1, CURRENT_TIMESTAMP)
[DB] Cl√© API de d√©veloppement cr√©√©e avec succ√®s
[DB] Structure de la base de donn√©es v√©rifi√©e
[DB] Cr√©ation de la table users...
CREATE TABLE IF NOT EXISTS users (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    username TEXT NOT NULL UNIQUE,
    password TEXT NOT NULL,
    email TEXT UNIQUE,
    role TEXT NOT NULL DEFAULT 'user',
    first_name TEXT,
    last_name TEXT,
    last_login TEXT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
  )
[DB] Cr√©ation de la table applications...
CREATE TABLE IF NOT EXISTS applications (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    description TEXT,
    cors_origins TEXT,
    settings TEXT,
    created_at TEXT NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TEXT NOT NULL DEFAULT CURRENT_TIMESTAMP,
    created_by INTEGER,
    FOREIGN KEY (created_by) REFERENCES users(id)
  )
[DB] Cr√©ation de la table api_keys...
CREATE TABLE IF NOT EXISTS api_keys (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    application_id INTEGER NOT NULL,
    key TEXT NOT NULL UNIQUE,
    hashed_key TEXT NOT NULL,
    description TEXT,
    is_active INTEGER DEFAULT 1,
    expires_at DATETIME,
    rate_limit INTEGER DEFAULT 100,
    usage_count INTEGER DEFAULT 0,
    last_used_at DATETIME,
    ip_restrictions TEXT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (application_id) REFERENCES applications(id) ON DELETE CASCADE
  )
[DB] Cr√©ation de la table conversion_logs...
CREATE TABLE IF NOT EXISTS conversion_logs (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    api_key_id INTEGER,
    application_id INTEGER NOT NULL,
    source_type TEXT NOT NULL,
    hl7_content TEXT NOT NULL,
    fhir_content TEXT,
    status TEXT NOT NULL,
    processing_time INTEGER,
    error_message TEXT,
    ip_address TEXT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (api_key_id) REFERENCES api_keys(id) ON DELETE SET NULL,
    FOREIGN KEY (application_id) REFERENCES applications(id) ON DELETE CASCADE
  )
[DB] Cr√©ation de la table system_metrics...
CREATE TABLE IF NOT EXISTS system_metrics (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    cpu_usage REAL,
    memory_usage REAL,
    disk_usage REAL,
    active_connections INTEGER,
    timestamp DATETIME DEFAULT CURRENT_TIMESTAMP
  )
[DB] Cr√©ation de la table notifications...
CREATE TABLE IF NOT EXISTS notifications (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,
    title TEXT NOT NULL,
    message TEXT NOT NULL,
    type TEXT NOT NULL DEFAULT 'info',
    read BOOLEAN NOT NULL DEFAULT 0,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
  )
[DB] Cr√©ation de la table api_activity_logs...
CREATE TABLE IF NOT EXISTS api_activity_logs (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    api_key_id INTEGER,
    application_id INTEGER NOT NULL,
    endpoint TEXT NOT NULL,
    method TEXT NOT NULL,
    status_code INTEGER NOT NULL,
    response_time INTEGER,
    ip_address TEXT,
    user_agent TEXT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (api_key_id) REFERENCES api_keys(id) ON DELETE SET NULL,
    FOREIGN KEY (application_id) REFERENCES applications(id) ON DELETE CASCADE
  )
[DB] Cr√©ation de la table api_usage_limits...
CREATE TABLE IF NOT EXISTS api_usage_limits (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    application_id INTEGER NOT NULL,
    api_key_id INTEGER,
    daily_limit INTEGER DEFAULT 1000,
    monthly_limit INTEGER DEFAULT 10000,
    current_daily_usage INTEGER DEFAULT 0,
    current_monthly_usage INTEGER DEFAULT 0,
    last_reset_daily DATETIME DEFAULT CURRENT_TIMESTAMP,
    last_reset_monthly DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (application_id) REFERENCES applications(id) ON DELETE CASCADE,
    FOREIGN KEY (api_key_id) REFERENCES api_keys(id) ON DELETE CASCADE
  )
[DB] Cr√©ation de la table system_logs...
CREATE TABLE IF NOT EXISTS system_logs (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    event_type TEXT NOT NULL,
    message TEXT NOT NULL,
    details TEXT,
    severity TEXT NOT NULL DEFAULT 'INFO',
    user_id INTEGER,
    ip_address TEXT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE SET NULL
  )
SELECT COUNT(*) as count FROM users WHERE username = 'admin'
SELECT COUNT(*) as count FROM applications WHERE name = 'Default'
[DB] Cr√©ation de l'application par d√©faut...
INSERT INTO applications (name, description) VALUES ('Default', 'Application par d√©faut pour le '/*+35 bytes*/)
[DB] Application par d√©faut cr√©√©e avec succ√®s
PRAGMA table_info(api_keys)
[DB] Structure de la table api_keys v√©rifi√©e
SELECT COUNT(*) as count FROM api_keys WHERE key = 'dev-key'
[DB] Initialisation de la base de donn√©es termin√©e avec succ√®s!
‚úÖ Base de donn√©es initialis√©e avec succ√®s
[TERMINOLOGY] Pr√©paration des terminologies fran√ßaises...
‚ö†Ô∏è Cr√©ation du fichier config.json par d√©faut...
[6/7] Finalisation de l'installation...
[7/7] Enregistrement des informations d'environnement...
‚úÖ Node.js local int√©gr√©: v20.15.1
‚úÖ Fichier .nodejsrc cr√©√© pour utiliser le Node.js int√©gr√©
==========================================================
     ‚úÖ Installation de FHIRHub termin√©e avec succ√®s
==========================================================

Pour d√©marrer l'application :
  ./start.sh

Pour d√©marrer avec Prometheus et Grafana locaux (sans Docker) :
  1. Modifiez le fichier .env pour activer l'installation locale :
     PROMETHEUS_LOCAL=true
     GRAFANA_LOCAL=true
  2. Ou utilisez directement : PROMETHEUS_LOCAL=true GRAFANA_LOCAL=true ./start.sh

Site web accessible sur : http://localhost:5001
Identifiants par d√©faut :
  Utilisateur : admin
  Mot de passe : admin123

Cl√© API de test : dev-key
Documentation API : http://localhost:5001/api-docs
==========================================================
sv@HONOR:~/FHIRhub$ sudo bash start.sh
==========================================================
   FHIRHub - Convertisseur HL7 v2.5 vers FHIR R4
   Version 1.3.0 - Compatible ANS
   2025-05-12 00:24:48
==========================================================
IMPORTANT: L'application utilise d√©sormais le port 5001 par d√©faut
           http://localhost:5001 au lieu de 5000
           Cette modification √©vite les conflits de port
----------------------------------------------------
Initialisation du syst√®me de conversion HL7 vers FHIR...
V√©rification des d√©pendances volumineuses...
‚úì Serveur HAPI FHIR d√©j√† install√©
Terminologies fran√ßaises manquantes. T√©l√©chargement automatique...
R√©cup√©ration des informations sur les terminologies fran√ßaises...
Erreur d'authentification: 401 {"error":"unauthorized_client","error_description":"Public client not allowed to retrieve service account"}
Erreur lors de la r√©cup√©ration des terminologies: list indices must be integers or slices, not str
Liste de CodeSystems FHIR r√©cup√©r√©e.
Liste de ValueSets FHIR r√©cup√©r√©e.
266 URLs de syst√®mes extraites.
Donn√©es sauvegard√©es dans le r√©pertoire 'french_terminology'
Chargement des terminologies fran√ßaises...
Activation du convertisseur optimis√© avec mappings ANS...
----------------------------------------------------
‚úì Serveur Multi-Terminologies fran√ßais initialis√©
‚úì Syst√®mes terminologiques ANS int√©gr√©s
----------------------------------------------------
[1/6] V√©rification des dossiers du projet...
‚úÖ Tous les dossiers requis sont pr√©sents
Cr√©ation de la nouvelle structure de r√©pertoires optimis√©e...
‚úÖ Structure de r√©pertoires optimis√©e pour Docker mise en place
[2/6] V√©rification de la configuration...
‚úÖ Fichier .env existant v√©rifi√©
V√©rification de la base de donn√©es SQLite...
‚úÖ Dossier de base de donn√©es d√©j√† existant
‚úÖ SQLite3 CLI trouv√©: 3.45.1 2024-01-30 16:01:20 e876e51a0ed5c5b3126f52e532044363a014bc594cfefa87ffb5b82257ccalt1 (64-bit)
V√©rification des extractions de noms fran√ßais...
‚úì Extracteur de noms fran√ßais initialis√©
‚úì Support des pr√©noms compos√©s (ex: JEAN-MICHEL, MARIE-PIERRE)
‚úì D√©tection des types de noms fran√ßais (nom de naissance, nom d'usage)
Initialisation du serveur FHIRHub...
[DB] Initialisation de la base de donn√©es...
[DB] Chemin de la base de donn√©es: /home/sv/FHIRhub/./storage/db/fhirhub.db
[DB] Structure de la base de donn√©es v√©rifi√©e
[TERMINOLOGY] Initialisation du service de terminologie
[TERMINOLOGY] Chargement des syst√®mes fran√ßais
[TERMINOLOGY] Chargement des syst√®mes communs
[TERMINOLOGY] Service de terminologie initialis√© avec succ√®s
[3/6] V√©rification de l'environnement Node.js...
Configuration Node.js locale d√©tect√©e...
‚úÖ Utilisation de Node.js local: v20.15.1
[4/6] V√©rification des d√©pendances...
‚úÖ Tous les modules Node.js requis sont pr√©sents
[5/6] V√©rification de Python...
‚úÖ Python 3 trouv√©: Python 3.12.3
[6/6] Pr√©paration du serveur...
V√©rification du port 5001...
‚úÖ Port 5001 disponible
==========================================================
   D√©marrage du serveur FHIRHub v1.3.0
   Application: http://localhost:5001
   M√©triques Prometheus: http://localhost:9091/metrics
==========================================================
Pr√©paration des r√©pertoires pour Loki, Grafana et Prometheus...
‚úÖ R√©pertoires pour Loki, Grafana et Prometheus pr√©par√©s
=== Test de connexion aux serveurs FHIR ===

V√©rification du serveur FHIR: http://localhost:8080/fhir
[DB] Ouverture de la base de donn√©es: ./storage/db/fhirhub.db
[DB] Connexion √† la base de donn√©es √©tablie avec succ√®s
[TERMINOLOGY] Fichier de mappings fran√ßais non trouv√©: /home/sv/FHIRhub/data/french_terminology_mappings.json
[CACHE] Initialisation du cache de conversion...
[CACHE] R√©pertoire de cache persistant : ./storage/data/cache
[CACHE] Nettoyage: 0 entr√©es expir√©es supprim√©es
[CACHE] Cache initialis√© avec taille maximale: 500 entr√©es
[CACHE] Strat√©gie d'√©viction: lru
Permissions d'√©criture v√©rifi√©es pour la base de donn√©es
Initialisation de la base de donn√©es SQLite...

      SELECT name FROM sqlite_master 
      WHERE type='table' AND name IN ('conversion_logs', 'users', 'applications', 'api_keys')
    
[DB] Toutes les tables existent d√©j√†, utilisation de la base de donn√©es existante.
SELECT COUNT(*) as count FROM conversion_logs
[DB] Aucune conversion trouv√©e dans la base de donn√©es
[TERMINOLOGY] R√©pertoire principal de terminologie: /home/sv/FHIRhub/french_terminology
[TERMINOLOGY] Nombre de fichiers JSON disponibles: 12
Client Ollama initialis√© avec point de terminaison: http://localhost:11434

/home/sv/FHIRhub/node_modules/better-sqlite3/lib/database.js:69
		[util.cppdb]: { value: new addon.Database(filename, filenameGiven, anonymous, readonly, fileMustExist, timeout, verbose || null, buffer || null) },
		                       ^
SqliteError: unable to open database file
    at new Database (/home/sv/FHIRhub/node_modules/better-sqlite3/lib/database.js:69:26)
    at Object.<anonymous> (/home/sv/FHIRhub/routes/ai-providers.js:19:12)
    at Module._compile (node:internal/modules/cjs/loader:1358:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1416:10)
    at Module.load (node:internal/modules/cjs/loader:1208:32)
    at Module._load (node:internal/modules/cjs/loader:1024:12)
    at Module.require (node:internal/modules/cjs/loader:1233:19)
    at require (node:internal/modules/helpers:179:18)
    at Object.<anonymous> (/home/sv/FHIRhub/app.js:1460:27)
    at Module._compile (node:internal/modules/cjs/loader:1358:14) {
  code: 'SQLITE_CANTOPEN'
}

Node.js v20.15.1
sv@HONOR:~/FHIRhub$ 
